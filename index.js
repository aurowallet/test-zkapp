let account;const initializeMina=async()=>{const e=document.getElementById("connectButton"),n=document.getElementById("getAccounts"),t=document.getElementById("requestAccountsResult");e.onclick=async()=>{if(window.mina){e.innerText="Onboarding in progress";let n=await window.mina.requestAccounts().catch((e=>e));n.message?e.innerText=n.message:(account=n,document.getElementById("accounts").innerHTML=n,e.innerText="Connected",e.disabled=!0)}else alert("No provider was found 请先安装 Auro Wallet")};const a=document.getElementById("onlyGetAccountButton"),i=document.getElementById("getAccountsResult");a.onclick=async()=>{if(window.mina){a.innerText="Onboarding in progress";let e=await window.mina.getAccounts();console.log("lsp==onlyGetAccountButton==data",e),a.innerText="Get Account",i.innerHTML=e}else alert("No provider was found 请先安装 Auro Wallet")},n.onclick=async()=>{if(window.mina){let e=await window.mina.requestAccounts().catch((e=>e)),n=e;e.message?t.innerHTML=e.message:t.innerHTML=n}};const c=document.getElementById("sendButton"),s=document.getElementById("sendAmountInput"),o=document.getElementById("receiveAddressInput"),d=document.getElementById("sendFee"),u=document.getElementById("sendMemo"),l=document.getElementById("sendResultDisplay");c.onclick=async()=>{let e=await window.mina.sendLegacyPayment({amount:s.value,to:o.value,fee:d.value,memo:u.value}).catch((e=>e));e.hash?l.innerHTML=e.hash:l.innerHTML=e.message};const m=document.getElementById("stakingButton"),g=document.getElementById("vaildatorAddressInput"),r=document.getElementById("stakeFee"),y=document.getElementById("stakeMemo"),w=document.getElementById("stakingResultDisplay");m.onclick=async()=>{let e=await window.mina.sendLegacyStakeDelegation({to:g.value,fee:r.value,memo:y.value}).catch((e=>e));e.hash?w.innerHTML=e.hash:w.innerHTML=e.message};const B=document.getElementById("signMessageButton"),I=document.getElementById("signMessageContent"),E=document.getElementById("signMessageResult");let M;B.onclick=async()=>{M=await window.mina.signMessage({message:I.value}).catch((e=>e)),M.signature?E.innerHTML=JSON.stringify(M.signature):E.innerHTML=M.message};const T=document.getElementById("signVerifyButton"),v=document.getElementById("verifyResult"),h=document.getElementById("verifySignature"),L=document.getElementById("verifyMessage");T.onclick=async()=>{let e={publicKey:account&&account.length>0?account[0]:"",signature:h.value,data:L.value},n=await window.mina.verifyMessage(e).catch((e=>e));v.innerHTML=n.error?.message||n};const f=document.getElementById("signFieldsButton"),H=document.getElementById("signFieldsContent"),A=document.getElementById("signFieldsResult");f.onclick=async()=>{M=await window.mina.signFields({message:JSON.parse(H.value)}).catch((e=>e)),M.signature?A.innerHTML=JSON.stringify(M.signature):A.innerHTML=M.message};const k=document.getElementById("signFieldsVerifyButton"),p=document.getElementById("verifyFieldsResult"),F=document.getElementById("verifyFieldsSignature"),C=document.getElementById("verifyFieldsMessage");k.onclick=async()=>{let e={publicKey:account&&account.length>0?account[0]:"",signature:F.value,payload:JSON.parse(C.value)},n=await window.mina.verifyFields(e).catch((e=>e));p.innerHTML=n.error?.message||n},setTimeout((async()=>{window.mina&&(window.mina.on("accountsChanged",x),window.mina.on("chainChanged",b),b(await window.mina.requestNetwork().catch((e=>e))),(async()=>{if(window.mina){let n=await window.mina.requestAccounts().catch((e=>e)),a=n;n.message?t.innerHTML=n.message:(account=a,document.getElementById("accounts").innerHTML=a,e.innerText="Connected",e.disabled=!0,t.innerHTML=a)}})())}),200);const R=document.getElementById("network");function b(e){R.innerHTML=e}function x(n){Array.isArray(n)&&(document.getElementById("accounts").innerHTML=n,0===n.length&&(e.innerText="Connect",e.disabled=!1))}};window.addEventListener("DOMContentLoaded",initializeMina);